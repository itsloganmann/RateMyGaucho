### RateMyGaucho Chrome Extension (Manifest V3) – UCSB GOLD Integration – Implementation Specification [Chrome MV3 Overview](https://developer.chrome.com/docs/extensions/mv3/intro/) [RateMy Slugs inspiration](https://chromewebstore.google.com/detail/ratemy-slugs/ddmahbdpmhbeohjjblfopgggdbfieboo?utm_source=item-share-cb)
- Objective: Integrate professor ratings into UCSB GOLD course selection pages with a native-looking card UI using packaged CSV data for fast, privacy-preserving, offline lookups. [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/) [UCSB Brand](https://www.ucsb.edu/brand)
- Non-goals: No runtime scraping, no secret API calls, no personal data collection or transmission. [Program Policies](https://developer.chrome.com/docs/webstore/program_policies/) [User Data policy](https://developer.chrome.com/docs/webstore/user_data/)

### Product Goals and Success Criteria [Chrome Extensions Docs](https://developer.chrome.com/docs/extensions/) [MV3 Get Started](https://developer.chrome.com/docs/extensions/mv3/getstarted/)
- Show Overall RMP rating and review count inline for each instructor on GOLD search/results/enrollment views, with a link to RMP profile/search. [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/) [MDN DOM APIs](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)
- Match UCSB GOLD visual style (colors, spacing, typography inheritance) so cards feel native and non-intrusive. [UCSB Brand](https://www.ucsb.edu/brand) [WCAG Contrast](https://www.w3.org/TR/WCAG21/#contrast-minimum)
- Maintain responsive, fast behavior with minimal CPU/Memory overhead on large result lists. [Performance Best Practices](https://developer.chrome.com/docs/extensions/mv3/performance/) [IntersectionObserver](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
- Require minimal permissions and avoid external requests to protect user privacy. [Least privilege](https://developer.chrome.com/docs/extensions/mv3/security/#least-privilege) [Permissions](https://developer.chrome.com/docs/extensions/mv3/declare_permissions/)

### Data Source and Schema [CSV RFC 4180](https://www.rfc-editor.org/rfc/rfc4180) [runtime.getURL](https://developer.chrome.com/docs/extensions/reference/runtime/#method-getURL)
- Source file: data/ucsb_professors_rmp.csv bundled with the extension for offline lookups. [web_accessible_resources](https://developer.chrome.com/docs/extensions/mv3/manifest/web_accessible_resources/) [Packaging assets](https://developer.chrome.com/docs/webstore/images/)
- Observed headers from provided CSV: department, first_name, last_name, rmp_score, num_reviews. [CSV Header Fields](https://www.rfc-editor.org/rfc/rfc4180#section-2) [Local file read](https://developer.chrome.com/docs/extensions/reference/runtime/#method-getURL)
- Types: department:string, first_name:string, last_name:string, rmp_score:number (0–5), num_reviews:number >= 0. [TypeScript types](https://www.typescriptlang.org/docs/handbook/2/everyday-types.html) [RMP site](https://www.ratemyprofessors.com/)
- Parsing: Use a small custom parser or PapaParse; ensure trimming, number coercion, and robust newline handling. [PapaParse](https://www.papaparse.com/) [PapaParse GitHub](https://github.com/mholt/PapaParse)

### Name Normalization and Matching [String normalize](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize) [Intl.Collator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Collator)
- Normalize diacritics via NFD and strip combining marks; lowercase, trim, and collapse multiple spaces. [Unicode normalization](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize) [Unicode character classes](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions/Character_classes)
- Support formats: "Last, First [M.]" and "First [M.] Last"; split instructors when multiple are listed. [RegExp split](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions) [String.split](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split)
- Primary key schema: key = `${last_name_lower}|${first_initial_lower}|${department_lower}` to disambiguate common names. [Map structure](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) [String.toLowerCase](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/toLowerCase)
- Fallback: if department is not available, pick the record with the highest num_reviews for that last+firstInitial. [Array.sort](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/sort) [Heuristic ranking](https://en.wikipedia.org/wiki/Heuristic)
- Optional fuzzy: apply Fuse.js to `(first last)` and `(last, first)` strings with a conservative threshold to minimize false positives. [Fuse.js](https://fusejs.io/) [Fuse.js GitHub](https://github.com/krisk/Fuse)

### Target URLs and Scope [Match patterns](https://developer.chrome.com/docs/extensions/mv3/match_patterns/) [Host permissions](https://developer.chrome.com/docs/extensions/mv3/declare_permissions/#host-permissions)
- Matches: https://my.sa.ucsb.edu/gold/* for course search, section listings, and enrollment pages within GOLD. [Match patterns](https://developer.chrome.com/docs/extensions/mv3/match_patterns/) [Host permissions](https://developer.chrome.com/docs/extensions/mv3/declare_permissions/#host-permissions)
- Exclude generic UCSB or SSO login screens by keeping match precise to GOLD subpaths. [Least privilege](https://developer.chrome.com/docs/extensions/mv3/security/#least-privilege) [Program Policies](https://developer.chrome.com/docs/webstore/program_policies/)
- Handle SPA-style navigations by monitoring DOM changes and URL transitions with MutationObserver and history events. [MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver) [History API](https://developer.mozilla.org/en-US/docs/Web/API/History_API)

### Architecture [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/) [Service workers](https://developer.chrome.com/docs/extensions/mv3/service_workers/)
- Start with a content-script-only architecture that loads and parses the CSV locally via chrome.runtime.getURL. [runtime.getURL](https://developer.chrome.com/docs/extensions/reference/runtime/#method-getURL) [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/)
- Avoid a background service worker unless future features require messaging or remote fetch; keep current design purely local. [Service worker rationale](https://developer.chrome.com/docs/extensions/mv3/service_workers/) [Runtime messaging](https://developer.chrome.com/docs/extensions/reference/runtime/#messaging)
- No network access is required; do not declare permissions beyond GOLD host and optional storage for options. [Permissions](https://developer.chrome.com/docs/extensions/mv3/declare_permissions/) [Privacy](https://developer.chrome.com/docs/webstore/user_data/)

### Manifest (MV3) [Manifest file](https://developer.chrome.com/docs/extensions/mv3/manifest/) [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/)
- manifest_version: 3; name: "RateMyGaucho"; version: "1.0.0"; description aligned to store listing guidelines. [MV3 Manifest](https://developer.chrome.com/docs/extensions/mv3/manifest/) [Store listing](https://developer.chrome.com/docs/webstore/cws-dashboard-listing/)
- content_scripts: matches GOLD URLs; include content/content.js and content/styles.css; run_at: document_idle. [run_at](https://developer.chrome.com/docs/extensions/mv3/content_scripts/#run_time) [Match patterns](https://developer.chrome.com/docs/extensions/mv3/match_patterns/)
- web_accessible_resources: expose data/ucsb_professors_rmp.csv only to GOLD pages for fetch via runtime.getURL. [web_accessible_resources](https://developer.chrome.com/docs/extensions/mv3/manifest/web_accessible_resources/) [runtime.getURL](https://developer.chrome.com/docs/extensions/reference/runtime/#method-getURL)
- permissions: ["storage"] (optional, for options); host_permissions: ["https://my.sa.ucsb.edu/gold/*"]. [Storage API](https://developer.chrome.com/docs/extensions/reference/storage/) [Host permissions](https://developer.chrome.com/docs/extensions/mv3/declare_permissions/#host-permissions)
- icons: 16/48/128 PNGs in icons/ directory for Chrome UI and store listing. [Icon guidelines](https://developer.chrome.com/docs/webstore/images/#icons) [Images best practices](https://developer.chrome.com/docs/webstore/images/)

### Project Structure [MV3 Get Started](https://developer.chrome.com/docs/extensions/mv3/getstarted/) [Images & assets](https://developer.chrome.com/docs/webstore/images/)
- manifest.json at repository root to define the extension. [Manifest file](https://developer.chrome.com/docs/extensions/mv3/manifest/) [MV3 Get Started](https://developer.chrome.com/docs/extensions/mv3/getstarted/)
- content/content.js and content/styles.css for DOM integration and styling. [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/) [CSS injection](https://developer.chrome.com/docs/extensions/mv3/content_scripts/#styles)
- data/ucsb_professors_rmp.csv bundled dataset used for lookups. [web_accessible_resources](https://developer.chrome.com/docs/extensions/mv3/manifest/web_accessible_resources/) [runtime.getURL](https://developer.chrome.com/docs/extensions/reference/runtime/#method-getURL)
- icons/ with 16/48/128 pixel icons for toolbar and listing. [Icon sizes](https://developer.chrome.com/docs/webstore/images/#icons) [Images best practices](https://developer.chrome.com/docs/webstore/images/)
- (Optional) options page in options/ for enable/disable and compact mode toggles. [Options page](https://developer.chrome.com/docs/extensions/mv3/options/) [Storage](https://developer.chrome.com/docs/extensions/reference/storage/)

### UI/UX Requirements [UCSB Brand](https://www.ucsb.edu/brand) [WCAG 2.1](https://www.w3.org/TR/WCAG21/)
- Card styling: rounded 6px radius, subtle shadow, 6–8px padding, compact grid layout. [CSS border-radius](https://developer.mozilla.org/en-US/docs/Web/CSS/border-radius) [CSS Box Model](https://developer.mozilla.org/en-US/docs/Learn/CSS/Building_blocks/The_box_model)
- Colors: UCSB Blue (#003660) for headings/links, UCSB Gold (#FDB515) for accents; ensure contrast compliance. [UCSB Colors](https://www.ucsb.edu/brand) [WCAG Contrast](https://www.w3.org/TR/WCAG21/#contrast-minimum)
- Typography: inherit page fonts; do not load external webfonts to respect MV3 CSP and performance. [MV3 CSP](https://developer.chrome.com/docs/extensions/mv3/intro/mv3-overview/) [Performance best practices](https://developer.chrome.com/docs/extensions/mv3/performance/)
- Information hierarchy: primary rating (bold, 1 decimal), secondary review count (muted), clear RMP link. [Information hierarchy](https://www.nngroup.com/articles/visual-hierarchy/) [MDN font-weight](https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight)
- Accessibility: keyboard focusable link, appropriate ARIA role, and sufficient hit target size. [WAI-ARIA](https://www.w3.org/TR/wai-aria/) [APG Patterns](https://www.w3.org/WAI/ARIA/apg/)

### DOM Integration Strategy [MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver) [IntersectionObserver](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
- Initialize at document_idle; scan for instructor elements and mark processed nodes via data attributes. [run_at](https://developer.chrome.com/docs/extensions/mv3/content_scripts/#run_time) [HTMLElement.dataset](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset)
- Use a single MutationObserver at a container root to detect added/removed rows and schedule scans with requestAnimationFrame. [MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver) [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame)
- Defer rendering for offscreen rows with IntersectionObserver to minimize layout/paint costs. [IntersectionObserver](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API) [Performance](https://developer.chrome.com/docs/extensions/mv3/performance/)
- Ensure idempotency by setting and checking data-rmg-initialized to prevent duplicates. [HTMLElement.dataset](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset) [Attribute selectors](https://developer.mozilla.org/en-US/docs/Web/CSS/Attribute_selectors)

### Rendering Details [Document.createElement](https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement) [insertAdjacentElement](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentElement)
- Insert a compact card adjacent to the instructor node using insertAdjacentElement('afterend', card). [insertAdjacentElement](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentElement) [DOM positioning](https://developer.mozilla.org/en-US/docs/Web/API/Element)
- Badge color thresholds: >=4.0 (good), 3.0–3.9 (ok), <3.0 (bad) with accessible foreground/background colors. [CSS color](https://developer.mozilla.org/en-US/docs/Web/CSS/color_value) [WCAG Contrast](https://www.w3.org/TR/WCAG21/#contrast-minimum)
- "View Profile" anchor opens new tab with rel=noopener noreferrer and a search query for UCSB professor. [HTML anchor](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a) [noopener guidance](https://web.dev/external-anchors-use-rel-noopener/)

### Options (Optional) [Options page](https://developer.chrome.com/docs/extensions/mv3/options/) [Storage API](https://developer.chrome.com/docs/extensions/reference/storage/)
- Settings: enabled:boolean (default true), compactMode:boolean (default false) stored in chrome.storage.local. [chrome.storage.local](https://developer.chrome.com/docs/extensions/reference/storage/#property-local) [Quota](https://developer.chrome.com/docs/extensions/reference/storage/#property-StorageArea-QUOTA_BYTES)
- Options UI: simple toggles with no inline scripts/styles to adhere to MV3 CSP. [MV3 CSP](https://developer.chrome.com/docs/extensions/mv3/intro/mv3-overview/) [Form controls](https://developer.mozilla.org/en-US/docs/Learn/Forms)

### Performance Considerations [Performance guide](https://developer.chrome.com/docs/extensions/mv3/performance/) [Idle Callback](https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback)
- Parse CSV once per page load and reuse a memoized lookup map for all renders. [Map](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) [Memoization](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map)
- Batch DOM writes within requestAnimationFrame to avoid layout thrash. [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame) [Layout thrashing](https://web.dev/avoid-large-complex-layouts-and-layout-thrashing/)
- Defer non-critical work (e.g., building fuzzy index) to requestIdleCallback when available. [requestIdleCallback](https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback) [Feature detection](https://developer.mozilla.org/en-US/docs/Learn/Tools_and_testing/Cross_browser_testing/Feature_detection)

### Privacy, Security, Compliance [Program Policies](https://developer.chrome.com/docs/webstore/program_policies/) [User Data](https://developer.chrome.com/docs/webstore/user_data/)
- Do not collect, store, or transmit personal data from GOLD; only parse instructor text content. [User Data policy](https://developer.chrome.com/docs/webstore/user_data/) [Privacy best practices](https://developer.chrome.com/docs/webstore/best_practices/)
- Keep permissions minimal: storage (optional) and host_permissions for GOLD only. [Least privilege](https://developer.chrome.com/docs/extensions/mv3/security/#least-privilege) [Permissions](https://developer.chrome.com/docs/extensions/mv3/declare_permissions/)
- Avoid inline scripts/styles in options; separate files to satisfy MV3 CSP. [MV3 CSP](https://developer.chrome.com/docs/extensions/mv3/intro/mv3-overview/) [Options page CSP](https://developer.chrome.com/docs/extensions/mv3/options/)

### Testing and Debugging [Load unpacked](https://developer.chrome.com/docs/extensions/mv3/getstarted/#load-unpacked) [Debugging guide](https://developer.chrome.com/docs/extensions/mv3/tut_debugging/)
- Load the extension via chrome://extensions with Developer mode and "Load unpacked". [Extensions page](https://developer.chrome.com/docs/extensions/mv3/getstarted/) [Load unpacked](https://developer.chrome.com/docs/extensions/mv3/getstarted/#load-unpacked)
- Use DevTools console to observe content script logs and inspect DOM insertions. [DevTools Console](https://developer.chrome.com/docs/devtools/console/) [DOM inspector](https://developer.chrome.com/docs/devtools/dom/)
- Verify no external network requests occur during normal operation. [Network panel](https://developer.chrome.com/docs/devtools/network/) [Privacy](https://developer.chrome.com/docs/webstore/user_data/)

### Packaging and Publishing [Publishing guide](https://developer.chrome.com/docs/webstore/publish/) [Store listing](https://developer.chrome.com/docs/webstore/cws-dashboard-listing/)
- Follow SemVer for versioning (e.g., 1.0.0) and update manifest accordingly. [SemVer](https://semver.org/) [Manifest version](https://developer.chrome.com/docs/extensions/mv3/manifest/)
- Provide 16/48/128 icons, clear description, and screenshots of integration on GOLD. [Images & Icons](https://developer.chrome.com/docs/webstore/images/) [Store listing](https://developer.chrome.com/docs/webstore/cws-dashboard-listing/)
- Zip the extension root and submit via Chrome Web Store Developer Dashboard. [Developer Dashboard](https://chrome.google.com/webstore/devconsole/) [Publish](https://developer.chrome.com/docs/webstore/publish/)

### Implementation Steps for Code Generation [MV3 Get Started](https://developer.chrome.com/docs/extensions/mv3/getstarted/) [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/)
- Create folders: content/, data/, icons/, and optionally options/ for settings UI. [Project layout](https://developer.chrome.com/docs/extensions/mv3/getstarted/) [Images](https://developer.chrome.com/docs/webstore/images/)
- Add manifest.json per Manifest section above with proper matches and web_accessible_resources. [Manifest](https://developer.chrome.com/docs/extensions/mv3/manifest/) [Match patterns](https://developer.chrome.com/docs/extensions/mv3/match_patterns/)
- Place ucsb_professors_rmp.csv into data/ with header row unchanged. [CSV RFC](https://www.rfc-editor.org/rfc/rfc4180) [runtime.getURL](https://developer.chrome.com/docs/extensions/reference/runtime/#method-getURL)
- Implement content/content.js: load CSV, parse, build lookup, observe DOM, and render cards idempotently. [MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver) [Document.createElement](https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement)
- Implement content/styles.css: scoped .rmg-* classes using UCSB colors and accessible contrasts. [CSS Basics](https://developer.mozilla.org/en-US/docs/Web/CSS) [UCSB Brand](https://www.ucsb.edu/brand)
- Load unpacked and validate behavior across GOLD pages; fix selector heuristics as needed. [Load unpacked](https://developer.chrome.com/docs/extensions/mv3/getstarted/#load-unpacked) [DevTools](https://developer.chrome.com/docs/devtools/)

### Prior Art and Inspiration [RateMy Slugs](https://chromewebstore.google.com/detail/ratemy-slugs/ddmahbdpmhbeohjjblfopgggdbfieboo?utm_source=item-share-cb) [Chrome Web Store](https://developer.chrome.com/docs/webstore/)
- RateMy Slugs (UCSC) demonstrates inline RMP metrics with color-coding and a profile link; mirror the compact card pattern adapted for UCSB GOLD and our CSV fields. [RateMy Slugs](https://chromewebstore.google.com/detail/ratemy-slugs/ddmahbdpmhbeohjjblfopgggdbfieboo?utm_source=item-share-cb) [UI guidance](https://developer.chrome.com/docs/webstore/images/)

### Acceptance Criteria [Definition of Done](https://martinfowler.com/bliki/DefinitionOfDone.html) [Manual QA](https://developer.chrome.com/docs/extensions/mv3/getstarted/)
- Ratings appear next to every instructor row on GOLD pages with correct values from CSV. [Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/) [DOM querying](https://developer.mozilla.org/en-US/docs/Web/API/Document/querySelectorAll)
- No console errors or warnings during navigation, filters, or pagination in GOLD. [DevTools Console](https://developer.chrome.com/docs/devtools/console/) [Error handling](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/try...catch)
- UI respects UCSB brand colors/spacing and maintains AA-level contrast where applicable. [UCSB Brand](https://www.ucsb.edu/brand) [WCAG Contrast](https://www.w3.org/TR/WCAG21/#contrast-minimum)
- The extension makes zero external requests except when the user clicks the RMP link. [Privacy](https://developer.chrome.com/docs/webstore/user_data/) [Network panel](https://developer.chrome.com/docs/devtools/network/)

### Appendix: Key APIs and References [Chrome Extensions Reference](https://developer.chrome.com/docs/extensions/reference/) [MDN Web Docs](https://developer.mozilla.org/)
- chrome.runtime.getURL for locating packaged CSV assets. [runtime.getURL](https://developer.chrome.com/docs/extensions/reference/runtime/#method-getURL) [MV3 Manifest](https://developer.chrome.com/docs/extensions/mv3/manifest/)
- chrome.storage.local for options state if options UI is enabled. [Storage API](https://developer.chrome.com/docs/extensions/reference/storage/) [Quota](https://developer.chrome.com/docs/extensions/reference/storage/#property-StorageArea-QUOTA_BYTES)
- DOM APIs: MutationObserver, IntersectionObserver, requestAnimationFrame, and createElement. [MutationObserver](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver) [IntersectionObserver](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
- Parsing helpers: PapaParse for CSV and Fuse.js for fuzzy matches (optional). [PapaParse](https://www.papaparse.com/) [Fuse.js](https://fusejs.io/)
